using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;

namespace lab9cc
{
    public partial class Form1 : Form
    {
        // Designer fields
        private TextBox Input;
        private TextBox Output;
        private Button Compile;

        public Form1()
        {
            InitializeComponent();
        }

        // Initialize UI controls
        private void InitializeComponent()
        {
            this.Input = new System.Windows.Forms.TextBox();
            this.Output = new System.Windows.Forms.TextBox();
            this.Compile = new System.Windows.Forms.Button();
            this.SuspendLayout();
            // 
            // Input
            // 
            this.Input.Location = new System.Drawing.Point(12, 12);
            this.Input.Name = "Input";
            this.Input.Size = new System.Drawing.Size(260, 23);
            this.Input.TabIndex = 0;
            // 
            // Output
            // 
            this.Output.Location = new System.Drawing.Point(12, 41);
            this.Output.Name = "Output";
            this.Output.ReadOnly = true;
            this.Output.Size = new System.Drawing.Size(260, 23);
            this.Output.TabIndex = 1;
            // 
            // Compile
            // 
            this.Compile.Location = new System.Drawing.Point(12, 70);
            this.Compile.Name = "Compile";
            this.Compile.Size = new System.Drawing.Size(75, 23);
            this.Compile.TabIndex = 2;
            this.Compile.Text = "Compile";
            this.Compile.UseVisualStyleBackColor = true;
            this.Compile.Click += new System.EventHandler(this.Compile_Click);
            // 
            // Form1
            // 
            this.ClientSize = new System.Drawing.Size(284, 111);
            this.Controls.Add(this.Compile);
            this.Controls.Add(this.Output);
            this.Controls.Add(this.Input);
            this.Name = "Form1";
            this.Text = "Form1";
            this.ResumeLayout(false);
            this.PerformLayout();
        }

        // Event handler and DFA logic
        private void Compile_Click(object sender, EventArgs e)
        {
            string Initial_State = "S0";
            string Final_State = "S3";

            var dict = new Dictionary<string, Dictionary<char, string>>();
            dict.Add("S0", new Dictionary<char, string>() { { 'a', "S1" }, { 'b', "Se" }, { 'c', "Se" } });
            dict.Add("S1", new Dictionary<char, string>() { { 'a', "Se" }, { 'b', "S2" }, { 'c', "Se" } });
            dict.Add("S2", new Dictionary<char, string>() { { 'a', "Se" }, { 'b', "Se" }, { 'c', "S3" } });
            dict.Add("S3", new Dictionary<char, string>() { { 'a', "Se" }, { 'b', "Se" }, { 'c', "S3" } });

            string state = Initial_State;
            string strinput = Input?.Text?.Trim() ?? string.Empty;

            if (string.IsNullOrEmpty(strinput))
            {
                Output.Text = "ERROR: input is empty";
                return;
            }

            foreach (char ch in strinput)
            {
                if (!dict.TryGetValue(state, out var transitions))
                {
                    state = "Se";
                    break;
                }

                if (!transitions.TryGetValue(ch, out var nextState))
                {
                    state = "Se";
                    break;
                }

                if (nextState == "Se")
                {
                    state = "Se";
                    break;
                }

                state = nextState;
            }

            Output.Text = state.Equals(Final_State, StringComparison.Ordinal) ? "RESULT OKAY" : "ERROR";
        }
    }
}